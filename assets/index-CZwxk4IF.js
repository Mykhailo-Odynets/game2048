(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function n(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(r){if(r.ep)return;r.ep=!0;const c=n(r);fetch(r.href,c)}})();const a={x:0,y:0},l={current:0,best:0};let d=[];const o=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];let y=!1,u=!1;const p=document.querySelector("#app"),M=document.querySelector("#score"),v=document.querySelector("#score--best"),g=()=>{m()},b=()=>{s(),m(),s(),s(),s()},L=()=>{s(),s(),m(),s(),s()},w=()=>{s(),s(),s(),m(),s()},f=()=>{p.innerHTML="",M.innerHTML=`${l.current}`,v.innerHTML=`${l.best}`,N();for(let e of o)for(let t of e){const n=document.createElement("div");n.classList.add("block",`block-${t}`),n.innerHTML=`${t}`,p.appendChild(n),t===2048&&(u=!0)}u&&E()},E=()=>{document.getElementsByClassName("win-message")[0].classList.remove("hidden")},S=()=>{d.length=0;for(let e in o)for(let t in o[e])o[e][t]===0&&d.push({[+e]:+t})},N=()=>{S();const e=d[Math.floor(Math.random()*d.length)],t=+Object.keys(e)[0];o[t][e[t]]=Math.floor(Math.random()*4)===3?4:2},m=()=>{for(let e in o)for(let t=1;t<o[e].length;t+=1){let n=t;for(;n>0&&o[e][n-1]===0;)o[e][n-1]=o[e][n],o[e][n]=0,n-=1;n>0&&o[e][n-1]===o[e][n]&&(o[e][n-1]*=2,o[e][n]=0,l.current+=o[e][n-1],l.current>l.best&&(l.best=l.current))}},s=()=>{for(let t=0;t<4/2;t+=1)for(let n=t;n<4-t-1;n+=1){const i=o[t][n];o[t][n]=o[n][3-t],o[n][3-t]=o[3-t][3-n],o[3-t][3-n]=o[3-n][t],o[3-n][t]=i}};f();document.querySelector("#play-again").addEventListener("click",()=>{o.length=0,o.push([0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]),l.current=0,u=!1,f(),document.getElementsByClassName("win-message")[0].classList.add("hidden")});document.addEventListener("keydown",e=>{if(!u){if(e.key==="ArrowLeft")g();else if(e.key==="ArrowUp")b();else if(e.key==="ArrowRight")L();else if(e.key==="ArrowDown")w();else return;f()}});document.addEventListener("touchstart",e=>{u||(a.x=e.touches[0].clientX,a.y=e.touches[0].clientY,y=!0)});document.addEventListener("touchmove",e=>{const t={x:e.touches[0].clientX,y:e.touches[0].clientY},n=t.x-a.x,i=t.y-a.y;(Math.abs(n)>50||Math.abs(i)>50)&&y&&(Math.abs(n)>Math.abs(i)?n>0?L():g():i>0?b():w(),y=!1,f())});
